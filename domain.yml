version: "3.1"

intents:
  - greet
  - start
  - provide_phone
  - provide_name
  - provide_lastname
  - provide_gender
  - provide_age
  - provide_region
  - provide_interests
  - skip_step
  - show_profile
  - show_events
  - show_communication
  - help
  - affirm
  - deny
  - back_to_menu
  - edit_profile
  - create_event
  # --- –î–û–ë–ê–í–õ–ï–ù–ù–´–ï –ù–ê–ú–ï–†–ï–ù–ò–Ø ---
  - provide_event_title
  - provide_event_date
  - provide_event_time
  - provide_event_location
  - provide_event_description
  - provide_event_interests
  - save_event
  - cancel_event
  - admin_upload_lists
  - admin_generate_users_report
  - admin_generate_events_report

entities:
  - phone_number
  - name
  - lastname
  - gender
  - age
  - region
  - interest
  - event_title
  - event_date
  - event_time
  - event_location
  - event_description

slots:
  phone_number:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: phone_number
  name:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: name
  lastname:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: lastname
  gender:
    type: categorical
    values:
      - male
      - female
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: gender
  age:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: age
  region:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: region
  interests:
    type: list
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: interest
  user_id:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  is_registered:
    type: bool
    influence_conversation: true
    mappings:
      - type: custom
  registration_step:
    type: text
    influence_conversation: false
    mappings:
      - type: custom
  # --- –î–û–ë–ê–í–õ–ï–ù–ù–´–ï –°–õ–û–¢–´ ---
  is_admin:
    type: bool
    influence_conversation: true
    mappings:
      - type: custom
  event_title:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: event_title
  event_date:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: event_date
  event_time:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: event_time
  event_location:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: event_location
  event_description:
    type: text
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: event_description
  event_interests:
    type: list
    influence_conversation: true
    mappings:
      - type: from_entity
        entity: interest

forms:
  registration_form:
    required_slots:
      - name
      - lastname
      - gender
      - age
      - region
      - interests
  # --- –î–û–ë–ê–í–õ–ï–ù–ù–ê–Ø –§–û–†–ú–ê ---
  create_event_form:
    required_slots:
      - event_title
      - event_date
      - event_time
      - event_location
      - event_interests

responses:
  utter_greet:
    - text: "–ü—Ä–∏–≤–µ—Ç! –Ø –±–æ—Ç –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π. –ß—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å, –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É '–ó–∞–ø—É—Å—Ç–∏—Ç—å'."
      buttons:
        - title: "–ó–∞–ø—É—Å—Ç–∏—Ç—å"
          payload: "/start"
  utter_ask_phone:
    - text: "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, +79991234567 –∏–ª–∏ 89991234567)"
  utter_ask_name:
    - text: "–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è (—Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã)"
  utter_ask_lastname:
    - text: "–í–≤–µ–¥–∏—Ç–µ –≤–∞—à—É —Ñ–∞–º–∏–ª–∏—é (—Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã)"
  utter_ask_gender:
    - text: "–£–∫–∞–∂–∏—Ç–µ –ø–æ–ª"
      buttons:
        - title: "–ú—É–∂"
          payload: '/provide_gender{"gender":"male"}'
        - title: "–ñ–µ–Ω"
          payload: '/provide_gender{"gender":"female"}'
        - title: "–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å"
          payload: "/skip_step"
  utter_ask_age:
    - text: "–£–∫–∞–∂–∏—Ç–µ –≤–∞—à –≤–æ–∑—Ä–∞—Å—Ç (—á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 120)"
  utter_ask_region:
    - text: "–£–∫–∞–∂–∏—Ç–µ –≤–∞—à —Ä–µ–≥–∏–æ–Ω (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ú–æ—Å–∫–≤–∞)"
  utter_ask_interests:
    - text: "–£–∫–∞–∂–∏—Ç–µ –≤–∞—à–∏ –∏–Ω—Ç–µ—Ä–µ—Å—ã —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–ø–æ—Ä—Ç, –º—É–∑—ã–∫–∞)"
  utter_main_menu:
    - text: "–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é:"
      buttons:
        - title: "üë§ –ú–æ–π –ø—Ä–æ—Ñ–∏–ª—å"
          payload: "/show_profile"
        - title: "üí¨ –û–±—â–µ–Ω–∏–µ"
          payload: "/show_communication"
        - title: "üé≠ –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è"
          payload: "/show_events"
        - title: "‚ùì –ü–æ–º–æ—â—å"
          payload: "/help"
  utter_profile:
    - text: "–í–∞—à –ø—Ä–æ—Ñ–∏–ª—å:\n{name} {lastname}\n–í–æ–∑—Ä–∞—Å—Ç: {age}\n–ü–æ–ª: {gender}\n–†–µ–≥–∏–æ–Ω: {region}\n–ò–Ω—Ç–µ—Ä–µ—Å—ã: {interests}"
      buttons:
        - title: "–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ"
          payload: "/edit_profile"
        - title: "–ù–∞–∑–∞–¥"
          payload: "/back_to_menu"
  utter_help:
    - text: "–≠—Ç–æ –±–æ—Ç –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π. –í—ã –º–æ–∂–µ—Ç–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è, –ø—Ä–∏–≥–ª–∞—à–∞—Ç—å –¥—Ä—É–∑–µ–π, –æ–±—â–∞—Ç—å—Å—è —Å —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ."
  utter_edit_profile:
    - text: "–î–∞–≤–∞–π—Ç–µ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º –≤–∞—à –ø—Ä–æ—Ñ–∏–ª—å. –° —á–µ–≥–æ –Ω–∞—á–Ω–µ–º?"
      buttons:
        - title: "–ò–∑–º–µ–Ω–∏—Ç—å –∏–º—è"
          payload: "/provide_name"
        - title: "–ù–∞–∑–∞–¥"
          payload: "/back_to_menu"
  # --- –î–û–ë–ê–í–õ–ï–ù–ù–´–ï –û–¢–í–ï–¢–´ ---
  utter_admin_menu:
    - text: "–ú–µ–Ω—é –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:"
      buttons:
        - title: "–ó–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–∫–∏"
          payload: "/admin_upload_lists"
        - title: "–û—Ç—á–µ—Ç –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º"
          payload: "/admin_generate_users_report"
        - title: "–û—Ç—á–µ—Ç –ø–æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è–º"
          payload: "/admin_generate_events_report"
        - title: "–ù–∞–∑–∞–¥"
          payload: "/back_to_menu"
  utter_ask_event_title:
    - text: "–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è"
  utter_ask_event_date:
    - text: "–í–≤–µ–¥–∏—Ç–µ –¥–∞—Ç—É –Ω–∞—á–∞–ª–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è (–≤ —Ñ–æ—Ä–º–∞—Ç–µ –¥–¥.–º–º.–≥–≥–≥–≥)"
  utter_ask_event_time:
    - text: "–í–≤–µ–¥–∏—Ç–µ –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è (–≤ —Ñ–æ—Ä–º–∞—Ç–µ —á—á:–º–º)"
  utter_ask_event_location:
    - text: "–í–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å –º–µ—Å—Ç–∞ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è"
  utter_ask_event_interests:
    - text: "–£–∫–∞–∂–∏—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å—ã, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—é (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)"
  utter_ask_save_event:
    - text: "–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ –≥–æ—Ç–æ–≤–æ. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å?"
      buttons:
        - title: "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"
          payload: "/save_event"
        - title: "–û—Ç–º–µ–Ω–∞"
          payload: "/cancel_event"

actions:
  - action_process_phone
  - action_validate_registration_input
  - action_save_user
  - action_show_events
  - action_show_profile
  - action_show_communication
  - action_create_event
  - action_edit_profile
  # --- –î–û–ë–ê–í–õ–ï–ù–ù–´–ï –î–ï–ô–°–¢–í–ò–Ø ---
  - action_check_admin
  - action_save_event
  - action_cancel_event
  - action_admin_upload_lists
  - action_admin_generate_users_report
  - action_admin_generate_events_report

session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true

